h1. Premises Gateway Feature

The Premises Gateway feature is an iRouter feature that facilitates the bidirectional movement of information between _iRouter_ services and the _Tracker Premises Documents_.  

The Premises Gateway feature contains three iRouter Component Factories and an Gateway EventHandler.

h2. EID Reader Gateway Component Factory

The EID Reader Gateway Component Factory is a factory for creating component gateways that transform EID(Electronic ID) numbers read from RFID(Radio Frequency ID) Tag Readers into iRouter _EID number_ products. 

h3. EID Numbers from Tag Readers

The Tracker Reader Feature and the Tracker Premises transaction editor provide the functionality for configuration, management, dynamic editing and interfacing of RFID(Radio Frequency Identification) EID(Electronic Identification) tag readers and Premises documents.  

Opening a Premises document with the Premises Transaction Editor will enable input connectivity with all the connected Tag Readers in the Readers view. During this transaction editing session when tags are read by a Tag reader, the EID numbers transmitted by the Tag Reader will be converted to one or more Animal history events, and added to the Premises document. The operator will see this as a dynamic change to the document.  

See the "com.verticon.tracker.reader feature":http://tracker-project.verticon.com/verticon_Tracker/admin/ticket/components/com.verticon.tracker.reader and the Tracker Business Intelligence Toolkit documentation for more details.


h3. EID Number Events to iRouter EID Products

To aid integration, Readers view connected Tag Readers will also publish EID numbers as events on the internal inter-process communication facility the EventAdmin Service. 

The EID Reader Gateway Components are gateways that subscribe to EID number Events that were published on the EventAdmin Service and re-produce them as _EID number_ products on the iRouter WireAdmin service.

To provide the gateway functionality, an EID Component implements @EventAdmin EventHandler@ and @WireAdmin Producer@ services that:
* Listen for Tag reader EventAdmin EID events that are generated by one or more Tag Readers 
* Transform the EID events coming from Tag Readers into iRouter _EID number_ products for processing by iRouter consumer services.

h2. Measurement Event Gateway Component Factory

The Measurement Event Gateway Component Factory is a factory for creating component gateways that transform iRouter _Measurement_ and _Position_ products into EventAdmin Measurement and Position Events. 

h3. iRouter Measurement and Position Products to EventAdmin Events

To provide the gateway functionality, a Measurement Event component implements the @WireAdmin Consumer@ service to consume:
* an iRouter _Measurement_ or a _Position_ product
* an _EID number_ product, which can come from an EID Reader Gateway component (mentioned above) or from any iRouter producer of _EID number_ products. 
* an optional _State_ product

The gateway caches the last received _Measurement_ and _Position_ object until a user configured triggering condition occurs, then it sends out the cached product with an ID value as event to the @EventAdmin@ Service. The ID value is determined from:
* ID implicit to the cached product
* _EID number_ product explicitly received and cached by the gateway

Two triggering conditions can be configured by the user
# _EID number_ product
# _State_ product 


h2. Gateway EventHandler

The Gateway EventHandler is a gateway service that transforms Measurement and Position events coming from the iRouter into 
Premises animal history events.

h3. Animal History Events

Tracker Editor Feature provides a Tracker Transaction Editor for creating animal event history events from EID(Electronic Identification) tag readers. 

See the "com.verticon.tracker.editor feature":http://tracker-project.verticon.com/verticon_Tracker/admin/ticket/components/com.verticon.tracker.editor and the Tracker Business Intelligence Toolkit documentation for more details.

h3. EventAdmin Events to Animal History Events 

The Premises Gateway implements @EventAdmin EventHandler@ to listen for EventAdmin Events coming from the _Measurement Event Gateway_ (mentioned above). The Premises Gateway transforms these events to Premises animal history events. 

* iRouter _Measurement_ products are transformed into animal history _weighIn_ events. 
* iRouter _Position_ products are transformed into animal history _position_ events.
* All other "SI":http://en.wikipedia.org/wiki/SI measurements originating from iRouter network attached physical sensors or internal iRouter business logic services can be saved as a __Generic Animal History Event__ in a Tracker Premises documents. For these measurement events a @Metatype OCD@ will have to be configured and its ID specified in the configuration of the Measurement Event Gateway service.

h2. Animal Life Data Gateway Component Factory

Premises documents contain both animal history and animal life data.  For external devices that require synchronization of animal life data, the Animal Life Data Gateway Component Factory creates services that produce a list of animal life data records extracted from a specified Premises document. These animal life data record products can be consumed by iRouter services to export animal life data to external devices. 

* Extraction process is triggered when a consumer connects to this service
* Data sent as a list of records containing specified animal attribute values 
* Reference premises document with URI
* User configures:
** URI of premises document
** Which animal attributes to use as fields
** Which order to place the fields
** Optional transformation of attribute values to field values
** Optional static values inserted as fields
** Refresh time before a document is reloaded and new records are created 

 
