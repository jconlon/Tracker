<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
	<chapter id="PremisesGatewayFeature">
	    <?dbhtml filename="premisesGateway/premisesGateway.html" ?>
		<title>iRouter Premises Gateway</title>
		<para>Many animal premises managers require the integration of sensors, actuators, weigh scales, and RFID readers.
		Traditional solutions are often custom software and network integration solutions that require business 
		analysts, programmers and installers to undertake a costly and time consuming development, integration
	    and deployment project.  Verticon's iRouter is a game changing alternative to high cost project integration 
	    efforts. The iRouter is a Just-In-Time integration solution for multiple input devices, sensors and 
	    actuators.</para>
		<para>The Premises Gateway feature is an iRouter feature that facilitates the bidirectional movement of information between 
			<emphasis>iRouter</emphasis> network attached sensors, actuators,  business logic services and  
			<emphasis>Tracker Premises Documents</emphasis>.  
		</para>
		<para></para>
		<note><para>See the <ulink url="http://tracker.verticon.com/Tracker/documentation/iRouter.pdf"> iRouter User Guide</ulink>
		for details about the iRouter.
		</para></note>
		<para>The Premises Gateway feature contains three iRouter Component Factories and an Gateway EventHandler.
		
		<table frame='all'><title>Premises Gateway Component Factories</title>
			<tgroup cols='7' align='left' colsep='1' rowsep='1'>
				<colspec colname='c1'/>
				<colspec colname='c2'/>
				<colspec colname='c3'/>
				<colspec colname='c4'/>
				<colspec colname='c5'/>
				<colspec colname='c6'/>
				<thead>
					<row>
  						<entry>Component Factory Name</entry>
  						<entry>Description</entry>
  						<entry>Consumes</entry>
  						<entry>Interface input</entry>
  						<entry>Produces</entry>
  						<entry>Interface output</entry>
					</row>
				</thead>
				<tbody>
					<row>
  						<entry><link linkend='PremisesEIDReaderGateway'>Premises EID Reader Gateway</link></entry>
						<entry>Gateway from EID Tag Readers to the iRouter network.</entry>
  						<entry></entry>
  						<entry>Subscribes to EventAdmin RFID Tag Read Events</entry>
  						<entry>EID Number Products</entry>
  						<entry></entry>
					</row>

					<row>
  						<entry><link linkend='PremisesMeasurementEventGateway'>Premises Measurement Event Gateway</link></entry>
						<entry>Gateway from the iRouter that creates Measurement and Position Events in Premises documents.
							<footnote><para>This function is performed by the 
							<link linkend='GatewayEventHandler'>Gateway EventHandler</link>.
						</para></footnote></entry>
  						<entry>Consumes Measurement, Position and optional State Products</entry>
  						<entry></entry>
  						<entry></entry>
  						<entry>Publishes EventAdmin Measurement and Position Events</entry>
					</row>
					
					<row>
  						<entry><link linkend='AnimalLifeDataGateway'>Animal Life Data Gateway</link></entry>
						<entry>Gateway from Premises document Animal elements to the iRouter network.</entry>
  						<entry></entry>
  						<entry>The Animal elements in a Premises document</entry>
  						<entry>List of Strings as a Product, where each string represents the life data for an animal.</entry>
  						<entry></entry>
					</row>
					
					
				</tbody>
			</tgroup>
		</table>
		
		</para>
		
		<section id="PremisesEIDReaderGateway">
			<title>Premises EID Reader Gateway</title>
			<para><emphasis>com.verticon.tracker.irouter.eid.event</emphasis></para>
			<para>Many livestock information management solutions require the integration of one or more RFID Tag Readers 
			with network attached sensors and actuators. The EID Reader Gateway Factory is a component factory for creating 
			services that interface with RFID Tag Readers integrating their Tag reads with iRouter network services. </para>
			<para>The EID Reader Gateway Factory services transform 
				<glossterm>EID</glossterm> numbers read from 
				<glossterm>RFID</glossterm> Tag Readers and produce iRouter 
				<emphasis>EID number</emphasis> products for consumption by iRouter Consumer services..  
			</para>
			
			<section id="EIDNumbersfromTagReaders">
				<title>RFID/EID Reader Background</title>
				<para>The Tracker Reader Feature and the Tracker Premises transaction editor provide the functionality for 
				configuration, management, dynamic editing and interfacing of <glossterm>RFID</glossterm>  tag readers 
				and Premises documents.  
				</para>
				<para>Opening a Premises document with the Premises Transaction Editor will enable input connectivity with 
				all the connected Tag Readers in the Readers view. During this transaction editing session when tags are 
				read by a Tag reader, the EID numbers transmitted by the Tag Reader will be converted to one or more Animal 
				history events, and added to the Premises document. The operator will see this as a dynamic change to the 
				document.  </para>
				<para>See the 
					<ulink url="http://tracker-project.verticon.com/verticon_Tracker/admin/ticket/components/com.verticon.tracker.reader">com.verticon.tracker.reader feature</ulink> and the Tracker Business Intelligence Toolkit documentation for more details.
				</para>
			</section>
			
			<section id="EIDNumberEventstoiRouterEIDProducts">
				<title>EID Number Events to iRouter EID Products</title>
				<para>Readers view connected Tag Readers publish EID numbers on the EventAdmin Service the internal inter-process 
				communication facility. </para>
				<para>The EID Reader Gateway Components are gateways that subscribe to EID numbers published on the EventAdmin 
					Service and re-produce them as 
					<emphasis>EID number</emphasis> products on the iRouter WireAdmin service.
				</para>
				<para>To provide the gateway functionality, an EID Component implements 
					<code>EventAdmin EventHandler</code> and 
					<code>WireAdmin Producer</code> services that:
				</para>
				<itemizedlist>
					<listitem>
						<para>Listen for Tag reader EventAdmin EID events that are generated by one or more Tag Readers </para>
					</listitem>
					<listitem>
						<para>Transform the EID events coming from Tag Readers into iRouter 
							<emphasis>EID number</emphasis> products for processing by iRouter consumer services.
						</para>
					</listitem>
				</itemizedlist>
			</section>
		</section>

		<section id="PremisesMeasurementEventGateway">
			<?dbhtml filename="premisesGateway/measurementEventGateway.html" ?>
			<title>Premises Measurement Event Gateway</title>
			<para><emphasis>com.verticon.tracker.irouter.measurement.event</emphasis></para>
			<para>The Measurement Event Gateway Factory is a factory for creating gateway services that consume 
				iRouter 
				<emphasis>Measurement</emphasis> and 
				<emphasis>Position</emphasis> products and transform them into EventAdmin Measurement and Position Events. 
			</para>
			<section id="iRouterMeasurementandPositionProductstoEventAdminEvents">
				<title>iRouter Measurement and Position Products to EventAdmin Events</title>
				<para>To provide the gateway functionality, a Measurement Event component implements the 
					<code>WireAdmin Consumer</code> service to consume:
				</para>
				<itemizedlist>
					<listitem>
						<para>an iRouter 
							<emphasis>Measurement</emphasis> or a 
							<emphasis>Position</emphasis> product
						</para>
					</listitem>
					<listitem>
						<para>an 
							<emphasis>EID number</emphasis> product, which can come from an EID Reader Gateway component (mentioned above) or from any iRouter producer of 
							<emphasis>EID number</emphasis> products. 
						</para>
					</listitem>
					<listitem>
						<para>an optional 
							<emphasis>State</emphasis> product
						</para>
					</listitem>
				</itemizedlist>
				<para>The gateway caches the last received 
					<emphasis>Measurement</emphasis> and 
					<emphasis>Position</emphasis> object until a user configured triggering condition occurs, then it sends out the cached product with an ID value as event to the 
					<code>EventAdmin</code> Service. The ID value is determined from:
				</para>
				<itemizedlist>
					<listitem>
						<para>ID implicit to the cached product</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>EID number</emphasis> product explicitly received and cached by the gateway
						</para>
					</listitem>
				</itemizedlist>
				<para>Two triggering conditions can be configured by the user</para>
				<orderedlist>
					<listitem>
						<para>
							<emphasis>EID number</emphasis> product
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>State</emphasis> product 
						</para>
					</listitem>
				</orderedlist>
			</section>
		</section>

		<section id="GatewayEventHandler">
			<?dbhtml filename="premisesGateway/gatewayEventHandler.html" ?>
			<title>Gateway EventHandler</title>
			<para>The Gateway EventHandler is a gateway service that transforms Measurement and Position events 
				coming from the iRouter into Premises animal history events.</para>
			<section id="AnimalHistoryEvents">
				<title>Animal History Events</title>
				<para>Tracker Editor Feature provides a Tracker Transaction Editor for creating animal event history events from 
					<glossterm>EID</glossterm> tag readers. 
				</para>
				<para>See the 
					<ulink url="http://tracker-project.verticon.com/verticon_Tracker/admin/ticket/components/com.verticon.tracker.editor">com.verticon.tracker.editor feature</ulink> and the Tracker Business Intelligence Toolkit documentation for more details.
				</para>
			</section>
			<section id="EventAdminEventstoAnimalHistoryEvents">
			   <?dbhtml filename="premisesGateway/eventAdminEventsToAnimalHistor.html" ?>
				<title>EventAdmin Events to Animal History Events </title>
				<para>The Premises Gateway implements 
					<code>EventAdmin EventHandler</code> to listen for EventAdmin Events coming from the 
					<emphasis>Measurement Event Gateway</emphasis> (mentioned above). The Premises Gateway transforms these events to Premises animal history events. 
				</para>
				<itemizedlist>
					<listitem>
						<para>iRouter 
							<emphasis>Measurement</emphasis> products are transformed into animal history 
							<emphasis>weighIn</emphasis> events. 
						</para>
					</listitem>
					<listitem>
						<para>iRouter 
							<emphasis>Position</emphasis> products are transformed into animal history 
							<emphasis>position</emphasis> events.
						</para>
					</listitem>
					<listitem>
						<para>All other 
							<ulink url="http://en.wikipedia.org/wiki/SI">SI</ulink> measurements originating from iRouter network attached physical sensors or internal iRouter business logic services can be saved as a 
							<emphasis role="italic">Generic Animal History Event</emphasis> in a Tracker Premises documents. For these measurement events a 
							<code>Metatype OCD</code> will have to be configured and its ID specified in the configuration of the Measurement Event Gateway service.
						</para>
					</listitem>
				</itemizedlist>
			</section>
		</section>

		<section id="AnimalLifeDataGateway">
			<?dbhtml filename="premisesGateway/animalLifeDataGateway.html" ?>
			<title>Animal Life Data Gateway</title>
			<para><emphasis>com.verticon.tracker.irouter.animal.data</emphasis></para>
			<para>Premises documents contain both animal history and animal life data.  For external devices that require 
			synchronization of animal life data, the Animal Life Data Gateway Factory creates services that produce a list
			of animal life data records extracted from a specified Premises document. These animal life data record products 
			can be consumed by iRouter services to export animal life data to external devices. </para>
			<itemizedlist>
				<listitem>
					<para>Extraction process is triggered when a consumer connects to this service</para>
				</listitem>
				<listitem>
					<para>Data sent as a list of records containing specified animal attribute values </para>
				</listitem>
				<listitem>
					<para>Reference premises document with URI</para>
				</listitem>
				<listitem>
					<para>User configures:</para>
					<itemizedlist>
						<listitem>
							<para>URI of premises document</para>
						</listitem>
						<listitem>
							<para>Which animal attributes to use as fields</para>
						</listitem>
						<listitem>
							<para>Which order to place the fields</para>
						</listitem>
						<listitem>
							<para>Optional transformation of attribute values to field values</para>
						</listitem>
						<listitem>
							<para>Optional static values inserted as fields</para>
						</listitem>
						<listitem>
							<para>Refresh time before a document is reloaded and new records are created </para>
						</listitem>
					</itemizedlist>
				</listitem>
			</itemizedlist>
		</section>

		<section id="PremisesExamples">
      <?dbhtml filename="premisesGateway/premisesGatewayExample.html" ?>
		<title>Premises Gateway Examples</title>
		<para>The iRouter and Tracker technology configurations in this section are simple 
	     solution examples for solving common livestock premises integration problems.</para>
		<section><title>Recording Animal Location Example</title>
		<para>
		An example of a simple Premises Gateway integration solution is the   
		<xref linkend="fig_premisesGatewayLocationExample" />. This is an iRouter Monitor view image snapshot 
		of a GPS unit integrated with RFID readers. The purpose is to record the locations 
		of scanned animals as Premises document Position events.
	    </para>
	    <para>
		This iRouter configuration example consists of:
		<itemizedlist>
			<listitem><para>A Bluetooth gps receiver</para></listitem>
			<listitem><para>An iRouter GPS Proxy component</para></listitem>
			<listitem><para>Three RFID Tag Readers configured in the Readers view</para></listitem>
			<listitem><para>iRouter EID Gateway component configured to listen to EID tag reads from all of the Tag Readers</para></listitem>
			<listitem><para>iRouter Measurement Event Gateway that creates position events when a tag is read</para></listitem>
			<listitem><para>iRouter Gateway EventHandler that adds position events to the active premises document</para></listitem>
		</itemizedlist>
		</para>
		<para>
		When this configuration is loaded into a Tracker Desktop and a premises transaction editing session is active; 
		<emphasis>any operator can record animal Position Events by scanning animals with any one of the three configured RFID readers</emphasis>.  
		</para>
		<note><para>Multiple Readers and multiple GPS sensors can be configured to create a comprehensive geo-location 
		aware premises for operator animal location resolution. For more information about configuring iRouter
		sensors and actuators and displaying active configurations with the iRouter configuration view see the 
		<ulink url="http://tracker.verticon.com/Tracker/documentation/iRouter.pdf"> iRouter User Guide</ulink>.</para> 
		<para>
		See the Agriculture Feature for details of Tracker's
		geo-location resolution solution. 
		</para></note>
		<figure id="fig_premisesGatewayLocationExample">
			<title>GPS Gateway Example</title>
			<mediaobject>
				<imageobject>
					<imagedata align="center" fileref="../images/premisesGatewayExample/gpsWithGateway.png" />
				</imageobject>
			</mediaobject>
		</figure>
		</section>
		
		<section>
		 <?dbhtml filename="premisesGateway/premisesGatewayWeighInExample.html" ?>
		 <title>Recording Animal Weight Example</title>
		<para>
		An example of a more complicated Premises Gateway integration solution is the   
		<xref linkend="fig_premisesGatewayWeightExample" />. This is an iRouter Monitor view image snapshot 
		of a <trademark>TruTest</trademark> scalehead indicator integrated with RFID readers. The purpose is to
		<itemizedlist>
			<listitem><para>synchronize the TruTest indicator with the animal life data from the active Premises document,</para></listitem>
			<listitem><para>intialize animal weighing session on the indicator by scanning an animal tag,</para></listitem>
			<listitem><para>record the weights of animals as Premises document WeighIn events when an operator presses the indicators <emphasis>ENTER</emphasis> key.</para></listitem>
		</itemizedlist>
	    </para>
	    <para>
		The configuration consists of:
		<itemizedlist>
			<listitem><para>A<trademark>TruTest</trademark> scalehead indicator and weigh bars</para></listitem>
			<listitem><para><trademark>TruTest</trademark> proxy component</para></listitem>
			<listitem><para><trademark>TruTest</trademark> business logic adapter components</para></listitem>
			<listitem><para>Animal Life Data synchronization components</para></listitem>
			<listitem><para>Three RFID Tag Readers configured in the Readers view</para></listitem>
			<listitem><para>iRouter EID Gateway component configured to listen to EID tag reads from all of the Tag Readers</para></listitem>
			<listitem><para>iRouter Measurement Event Gateway that sends weight and EID when a operator presses the enter key on the scalehead</para></listitem>
			<listitem><para>iRouter Gateway EventHandler that adds weighIn events to the active premises document</para></listitem>
		</itemizedlist>
		</para>
		<para>
		When this configuration is loaded into a Tracker Desktop and a premises transaction editing session is active; 
		<emphasis>any operator can scan animals with any one of the three configured RFID readers</emphasis> 
		to identify the animal to the scalehead indicator. When an operator presses the <emphasis>ENTER</emphasis> 
		key on the indicator, a weighIn event, will be added to the scanned animal's event history on the Premises 
		document.  
		</para>
		
		<note><para>Multiple Readers and multiple scaleheads can be configured to create a comprehensive multi station 
		weighIn facility for animals. For more information about configuring iRouter
		sensors and actuators and displaying active configurations with the iRouter configuration view see the 
		<ulink url="http://tracker.verticon.com/Tracker/documentation/iRouter.pdf"> iRouter User Guide</ulink>.</para> 
		<para>
		See the TruTest Feature for details of iRouter
		<trademark>TruTest</trademark> integration solution. 
		</para></note>
		<figure id="fig_premisesGatewayWeightExample">
			<title>Animal Weight Gateway Example</title>
			<mediaobject>
				<imageobject>
					<imagedata align="center" fileref="../images/premisesGatewayExample/animalWeight.png" />
				</imageobject>
			</mediaobject>
		</figure>
		</section>
		</section>
	</chapter>
	